{% extends 'base.html' %}

{% block title %}PassGuard - Проверка сложности пароля{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8 mx-auto">
        <!-- Заголовок -->
        <div class="text-center mb-5">
            <h1 class="mb-3">
                <i class="bi bi-search text-primary"></i> Анализ сложности пароля
            </h1>
            <p class="lead text-muted">
                Проверьте надежность вашего пароля по 10-балльной шкале
            </p>
        </div>

        <!-- Форма проверки -->
        <div class="card shadow mb-4">
            <div class="card-body">
                <form method="post" action="{% url 'core:check_strength' %}" id="password-strength-form">
                    {% csrf_token %}
                    
                    <div class="mb-4">
                        <label for="password" class="form-label fw-bold">
                            <i class="bi bi-key"></i> Введите пароль для анализа:
                        </label>
                        <input type="password" 
                            class="form-control form-control-lg" 
                            id="password" 
                            name="password" 
                            placeholder="Введите ваш пароль для анализа сложности"
                            required>
                    </div>

                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary btn-lg" id="check-button">
                            <i class="bi bi-search"></i> Проверить пароль
                        </button>
                        <div class="form-text text-center mt-2">
                            Нажмите Enter или кликните на кнопку
                        </div>
                    </div>
                </form>
            </div>
        </div>

        {% if result %}
        <div class="card shadow mt-4">
            <div class="card-body">
                <h4 class="card-title">
                    <i class="bi bi-clipboard-check text-primary"></i>
                    Результат анализа
                </h4>

                <!-- Оценка сложности -->
                <div class="alert alert-{{ result.alert_class }}">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="alert-heading mb-0">{{ result.message }}</h5>
                        <span class="badge bg-{{ result.badge_class }} fs-5">
                            {{ result.score }}/10
                        </span>
                    </div>

                    <!-- Прогресс-бар -->
                    <div class="mt-3">
                        <div class="progress" style="height: 25px;">
                            <div class="progress-bar bg-{{ result.badge_class }}"
                                 role="progressbar"
                                 style="width: {{ result.score_percentage }}%"
                                 aria-valuenow="{{ result.score }}"
                                 aria-valuemin="0"
                                 aria-valuemax="10">
                                {{ result.score }}/10
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Детальный анализ -->
                <div class="mt-4">
                    <h5><i class="bi bi-list-check"></i> Критерии проверки:</h5>
                    <div class="list-group">
                        {% for check in result.checks %}
                        <div class="list-group-item">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <i class="bi bi-{% if check.passed %}check-circle text-success{% else %}x-circle text-danger{% endif %}"></i>
                                    {{ check.name }}
                                </div>
                                <span class="badge bg-{% if check.passed %}success{% else %}danger{% endif %}">
                                    {% if check.passed %}✓{% else %}✗{% endif %}
                                </span>
                            </div>
                            {% if check.details %}
                            <small class="text-muted">{{ check.details }}</small>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Рекомендации -->
                <div class="mt-4">
                    <h5><i class="bi bi-lightbulb"></i> Рекомендации:</h5>
                    <div class="alert alert-info">
                        <ul class="mb-0">
                            {% for tip in result.tips %}
                            <li>{{ tip }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Шкала оценок -->
        <div class="card shadow mt-5">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="bi bi-speedometer2"></i> Шкала оценки сложности
                </h5>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Оценка</th>
                                <th>Уровень</th>
                                <th>Описание</th>
                                <th>Цвет</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>0-3</td>
                                <td>Очень слабый</td>
                                <td>Может быть взломан мгновенно</td>
                                <td><span class="badge bg-danger">Опасность</span></td>
                            </tr>
                            <tr>
                                <td>4-5</td>
                                <td>Слабый</td>
                                <td>Легко взломать за минуты</td>
                                <td><span class="badge bg-warning">Слабый</span></td>
                            </tr>
                            <tr>
                                <td>6-7</td>
                                <td>Средний</td>
                                <td>Требуется время для взлома</td>
                                <td><span class="badge bg-info">Средний</span></td>
                            </tr>
                            <tr>
                                <td>8-9</td>
                                <td>Сильный</td>
                                <td>Надежный пароль</td>
                                <td><span class="badge bg-success">Сильный</span></td>
                            </tr>
                            <tr>
                                <td>10</td>
                                <td>Очень сильный</td>
                                <td>Максимальная защита</td>
                                <td><span class="badge bg-primary">Отличный</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Информационный блок -->
        <div class="card shadow mt-5 border-info">
            <div class="card-body">
                <h5 class="card-title">
                    <i class="bi bi-info-circle text-info"></i> Как работает анализ?
                </h5>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <i class="bi bi-1-circle text-primary"></i>
                        <strong>Безопасность:</strong> Ваш пароль анализируется локально и никуда не отправляется.
                    </li>
                    <li class="list-group-item">
                        <i class="bi bi-2-circle text-primary"></i>
                        <strong>Проверка:</strong> Пароль проверяется на 7 критериев
                    </li>
                    <li class="list-group-item">
                        <i class="bi bi-3-circle text-primary"></i>
                        <strong>Результат:</strong> Вы получаете информацию о сложности пароля
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}